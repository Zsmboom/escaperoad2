async function captureGameScreen() { try { const stream = await navigator.mediaDevices.getDisplayMedia({ video: { cursor: "always" }, audio: false }); const video = document.createElement("video"); video.srcObject = stream; await video.play(); const canvas = document.createElement("canvas"); canvas.width = video.videoWidth; canvas.height = video.videoHeight; const ctx = canvas.getContext("2d"); ctx.drawImage(video, 0, 0); stream.getTracks().forEach(track => track.stop()); const imageUrl = canvas.toDataURL("image/jpeg"); const previewImages = document.querySelectorAll(".game-card img"); previewImages.forEach(img => { img.src = imageUrl; }); localStorage.setItem("gameScreenshot", imageUrl); alert("截图成功！已更新预览图。"); } catch (err) { console.error("截图失败:", err); alert("截图失败，请确保允许屏幕捕获权限。"); } }
